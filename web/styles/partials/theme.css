/* ==========================
   Dark Mode Theme
   ========================== */

@media (prefers-color-scheme: dark) {
  /* Dark mode variables */
  :root {
    --bg: var(--dark-bg-primary);
    --fg: var(--dark-fg-primary);
    --muted-fg: var(--dark-muted-fg);
    --border: var(--dark-border);
    --primary: var(--dark-primary);
    --text-high-contrast: var(--dark-text-high-contrast);
  }

  /* Links */
  a { color: var(--dark-link); }
  a:visited { color: var(--dark-link-visited); }
  a:hover, a:focus-visible { color: var(--dark-link-hover); }

  /* Header */
  header.sticky {
    background: color-mix(in oklab, var(--bg) 86%, transparent);
    border-bottom-color: var(--border);
  }

  /* Brand badge */
  .brand-badge {
    background: var(--primary);
    color: var(--white);
    box-shadow: 0 0 0 1px rgb(255 255 255 / 14%), 0 4px 16px var(--shadow-dark);
  }

  .brand-badge::before {
    background: var(--white);
    color: var(--primary);
    box-shadow: 0 2px 8px var(--shadow-dark);
  }

  .brand-badge:hover {
    box-shadow: 0 4px 12px var(--shadow-blue-dark), 0 0 0 1px rgb(255 255 255 / 14%);
  }

  /* Cards */
  .card {
    background: color-mix(in oklab, var(--bg) 88%, white 12%);
    border-color: var(--border);
    box-shadow: 0 1px 0 rgb(255 255 255 / 6%) inset, 0 8px 24px var(--shadow-dark);
  }

  /* Section cards */
  .section-card {
    background: color-mix(in oklab, var(--bg) 88%, white 12%);
    box-shadow: 0 1px 0 rgb(255 255 255 / 6%) inset, 0 8px 24px var(--shadow-dark);
  }

  /* Law detail card */
  .law-detail .card {
    background: color-mix(in oklab, var(--bg) 88%, white 12%);
    box-shadow: 0 1px 0 rgb(255 255 255 / 6%) inset, 0 8px 24px var(--shadow-dark);
  }

  /* Footer */
  .footer {
    background: color-mix(in oklab, var(--bg) 90%, white 10%);
    border-top-color: var(--border);
  }

  .section-footer,
  .law-detail .law-meta {
    background: color-mix(in oklab, var(--bg) 86%, white 14%);
    border-top-color: var(--border);
  }

  /* Buttons - only dark mode specific overrides */
  .btn, button {
    box-shadow: 0 0 0 1px rgb(255 255 255 / 8%) inset;
  }

  .btn.outline, button.outline {
    background: color-mix(in oklab, var(--bg) 86%, white 14%);
    border-color: rgb(255 255 255 / 22%);
  }

  .btn.outline:hover, button.outline:hover,
  .btn.outline:focus-visible, button.outline:focus-visible {
    background: color-mix(in oklab, var(--bg) 80%, white 20%);
    border-color: rgb(255 255 255 / 32%);
  }

  /* Inputs */
  input[type='text'],
  input[type='email'],
  textarea,
  select,
  .form-control,
  .share-form-container .form-group textarea,
  .share-form-container .form-group input {
    background: color-mix(in oklab, var(--bg) 92%, white 8%);
    color: var(--fg);
    border: 1.5px solid rgb(255 255 255 / 25%);
  }

  input[type='text']:hover,
  input[type='email']:hover,
  textarea:hover,
  select:hover,
  .form-control:hover,
  .share-form-container .form-group textarea:hover,
  .share-form-container .form-group input:hover {
    border-color: rgb(255 255 255 / 35%);
  }

  .submit-checkbox-group input[type="checkbox"] {
    background: color-mix(in oklab, var(--bg) 92%, white 8%);
    border: 1.5px solid rgb(255 255 255 / 25%);
  }

  /* Content cards */
  .content-card {
    background: color-mix(in oklab, var(--bg) 88%, white 12%);
    border-color: var(--border);
    box-shadow: 0 1px 0 rgb(255 255 255 / 6%) inset, 0 8px 24px var(--shadow-dark);
  }

  /* Navigation dropdown */
  .nav-dropdown {
    background: color-mix(in oklab, var(--bg) 88%, white 12%);
    box-shadow: 0 1px 0 rgb(255 255 255 / 6%) inset, 0 8px 24px var(--shadow-dark);
  }

  /* Search field select dropdowns */
  .search-field select {
    background-color: color-mix(in oklab, var(--bg) 92%, white 8%);
    box-shadow: 0 1px 3px var(--shadow-dark);
  }

  .search-field select:hover {
    background-color: color-mix(in oklab, var(--bg) 88%, white 12%);
    box-shadow: 0 2px 6px var(--shadow-dark);
  }

  .search-field select:focus {
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--btn-primary-bg) 30%, transparent 70%);
  }

  /* Modal */
  .modal-content {
    background: color-mix(in oklab, var(--bg) 88%, white 12%);
    box-shadow: 0 1px 0 rgb(255 255 255 / 6%) inset, 0 20px 60px rgb(0 0 0 / 50%);
  }

  /* Voting buttons - no overrides needed, base styles work for dark mode */

  button[data-vote='down']:hover {
    filter: saturate(1.2) brightness(1.2);
  }

  /* Pagination */
  .pagination .btn[aria-current='page'] {
    background: var(--btn-primary-bg);
    border-color: var(--btn-primary-bg);
    color: var(--btn-primary-fg);
    box-shadow: 0 4px 14px var(--shadow-blue-dark);
  }

  .pagination .btn:hover {
    filter: brightness(1.08);
  }


  /* Blockquote */
  .blockquote {
    border-left-color: color-mix(in oklab, var(--btn-primary-bg) 85%, white 15%);
    background: color-mix(in oklab, var(--bg) 88%, white 12%);
  }

  /* Calculator semantic states (dark mode) */
  .calc-ok {
    background: var(--dark-success-bg);
    color: var(--dark-success-fg);
  }

  .calc-warn {
    background: var(--dark-warning-bg);
    color: var(--dark-warning-fg);
  }

  .calc-orange {
    background: var(--dark-orange-bg);
    color: var(--dark-orange-fg);
  }

  .calc-danger {
    background: var(--dark-error-bg);
    color: var(--dark-error-fg);
  }

  .calc-dark {
    background: var(--dark-dark-bg);
    color: var(--dark-dark-fg);
  }

  /* Calculator simple values - ensure sufficient contrast in dark mode */
  .sod-simple-value {
    color: var(--dark-link-hover);
  }

  /* Skeleton loading */
  .skeleton {
    background: linear-gradient(90deg, var(--dark-skeleton-bg) 25%, var(--dark-skeleton-shimmer) 37%, var(--dark-skeleton-bg) 63%);
  }

  /* Search highlight - ensure dark text on light yellow background (WCAG 1.4.3) */
  mark {
    color: #111827;
  }
}
